@*
 * Copyright 2019 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import include._
@import forms2._
@import models.bankdetails._
@import utils.StatusConstants
@import models.status._
@import config.ApplicationConfig
@import forms.EmptyForm

@(bankDetails: BankDetails, index: Integer)(implicit request: Request[_],m:Messages, lang: Lang)

@header = {
    @heading("title.cya", "summary.bankdetails")
}

@main(
    title = Messages("title.cya") + " - " + Messages("summary.bankdetails"),
    heading = header
) {

@bankDetails.accountName.map { accountName =>
@checkYourAnswers(question = Messages("bankdetails.bankaccount.accountname.title"),
editUrl = controllers.bankdetails.routes.BankAccountNameController.getIndex(index, true).toString
) {
@accountName
}
}

    @bankDetails.bankAccountType.map { bankAccountType =>
        @checkYourAnswers(question = Messages("bankdetails.accounttype.title"),
            editUrl = controllers.bankdetails.routes.BankAccountTypeController.get(index, true).toString
        ) {
            @bankAccountType match {
                case PersonalAccount => { @Messages("bankdetails.summary.accounttype.lbl.01") }
                case BelongsToBusiness => { @Messages("bankdetails.summary.accounttype.lbl.02") }
                case BelongsToOtherBusiness => { @Messages("bankdetails.summary.accounttype.lbl.03") }
            }
        }
    }



    @bankDetails.bankAccount.map { bankAccount =>

            @checkYourAnswers(  question = Messages("bankdetails.bankaccount.accounttype.title"),
                                editUrl = controllers.bankdetails.routes.BankAccountIsUKController.get(index, true).toString
            ) {
                @bankAccount.isUk match {
                    case Some(BankAccountIsUk(true)) =>  { @Messages("lbl.yes") }
                    case Some(BankAccountIsUk(false)) => { @Messages("lbl.no") }
                    case _ => {}
                }
            }

            @bankAccount.hasIban match {
                case Some(BankAccountHasIban(true)) => {
                    @checkYourAnswers(  question = Messages("bankdetails.bankaccount.hasiban"),
                                        editUrl = controllers.bankdetails.routes.BankAccountHasIbanController.get(index, true).toString
                    ) {
                        @Messages("lbl.yes")
                    }}
                case Some(BankAccountHasIban(false)) => {
                    @checkYourAnswers(  question = Messages("bankdetails.bankaccount.hasiban"),
                                        editUrl = controllers.bankdetails.routes.BankAccountHasIbanController.get(index, true).toString
                    ) {
                        @Messages("lbl.no")
                    }}
                case _ => {}
            }

            @bankAccount.account match {
                case Some(ba:UKAccount) => {
                    @checkYourAnswers(  question = Messages("bankdetails.bankaccount.accountnumber"),
                                        editUrl = controllers.bankdetails.routes.BankAccountUKController.get(index, true).toString
                    ) {
                        @ba.accountNumber
                    }
                    @checkYourAnswers(  question = Messages("bankdetails.bankaccount.sortcode"),
                                        editUrl = controllers.bankdetails.routes.BankAccountUKController.get(index, true).toString
                    ) {
                        @ba.displaySortCode
                    }
                }
                case Some(ba: NonUKAccountNumber) => {
                    @checkYourAnswers(  question = Messages("bankdetails.bankaccount.accountnumber"),
                                        editUrl = controllers.bankdetails.routes.BankAccountNonUKController.get(index, true).toString
                    ) {
                        @ba.accountNumber
                    }
                }
                case Some(ba: NonUKIBANNumber) => {
                    @checkYourAnswers(  question = Messages("bankdetails.bankaccount.iban"),
                                        editUrl = controllers.bankdetails.routes.BankAccountIbanController.get(index, true).toString
                    ) {
                        @ba.IBANNumber
                    }
                }
                case _ => {}

        }
    }

    @form(EmptyForm, controllers.bankdetails.routes.SummaryController.post(index)) {
        @submit(false, Some(Messages("button.checkyouranswers.acceptandaddbankaccount")), false, buttonId = Some("accept-and-add"))
    }

}

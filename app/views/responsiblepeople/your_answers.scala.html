@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import include._
@import include.forms2._
@import models.responsiblepeople.ResponsiblePerson
@import utils.StatusConstants
@import forms.EmptyForm
@import config.ApplicationConfig

@(responsiblePeopleComplete: Seq[(ResponsiblePerson, Int)], responsiblePeopleIncomplete: Seq[(ResponsiblePerson,Int)])(implicit request: Request[_],m:Messages)

@rpList(responsiblePeople: Seq[(ResponsiblePerson, Int)]) = {
    <ul class="list">
    @responsiblePeople.map { case (rp, index) =>
        @rp.personName.map { pn =>
            @checkYourAnswersListing(
                item = pn.fullName,
                editUrl = rp.isComplete match {
                    case true => controllers.responsiblepeople.routes.DetailedAnswersController.get(index + 1, true).toString
                    case false => controllers.responsiblepeople.routes.PersonNameController.get(index+1, false, None).toString
                },
                removeUrl = controllers.responsiblepeople.routes.RemoveResponsiblePersonController.get(index + 1, true).toString
            )
        }
    }
    </ul>
}

@header = {
    @heading("responsiblepeople.whomustregister.title", "summary.responsiblepeople")
}

@main(
    title = Messages("responsiblepeople.whomustregister.title") + " - " + Messages("summary.responsiblepeople"),
    heading = header
) {

    <p>@Messages("responsiblepeople.whomustregister.ymr")</p>

    <ul class="list list-bullet">
        <li>@Messages("responsiblepeople.whomustregister.line_1")</li>
        <li>@Messages("responsiblepeople.whomustregister.line_2")</li>
        <li>@Messages("responsiblepeople.whomustregister.line_3")</li>
        <li>@Messages("responsiblepeople.whomustregister.line_4")</li>
        <li>@Messages("responsiblepeople.whomustregister.line_5")</li>
    </ul>

    <p><a id="addResponsiblePerson" href="@controllers.responsiblepeople.routes.ResponsiblePeopleAddController.get(false)">@Messages("responsiblepeople.check_your_answers.add")</a></p>

    @if(responsiblePeopleIncomplete.nonEmpty) {
        <h2>@Messages("responsiblepeople.check_your_answers.incomplete")</h2>
        @rpList(responsiblePeopleIncomplete)
    }

    @if(responsiblePeopleComplete.nonEmpty) {
        @if(responsiblePeopleIncomplete.nonEmpty) {
            <h2>@Messages("responsiblepeople.check_your_answers.complete")</h2>
        }
        @rpList(responsiblePeopleComplete)
    }

    @if(responsiblePeopleComplete.isEmpty && responsiblePeopleIncomplete.isEmpty) {
        <p>@Messages("responsiblepeople.whomustregister.nopeople")</p>
    }

    @if(ApplicationConfig.hasAcceptedToggle) {
        @form(EmptyForm, controllers.responsiblepeople.routes.SummaryController.post()) {
            @submit(false, Some(Messages("button.returntoapplicationprogress")), false)
        }
    } else {
        @anchor(
            attrHref = controllers.routes.RegistrationProgressController.get().toString,
            attrRole = true,
            linkText = Messages("button.summary.acceptandcomplete")
        )

    }
}
